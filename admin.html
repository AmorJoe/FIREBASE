<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - SkinScan AI</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="admin-body">
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-wrapper">
                    <i class="fas fa-dna logo-icon"></i>
                    <span class="logo-text">SkinScan</span>
                </div>
                <button id="sidebar-toggle" class="sidebar-toggle-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3>MAIN</h3>
                    <ul>
                        <li class="active" data-tab="dashboard">
                            <i class="fas fa-house"></i> <span>Dashboard</span>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3>MANAGEMENT</h3>
                    <ul>
                        <li data-tab="users">
                            <i class="fas fa-users"></i> <span>Users</span>
                        </li>

                        <li data-tab="reports">
                            <i class="fas fa-file-medical"></i> <span>Reports</span>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3>SYSTEM</h3>
                    <ul>
                        <li data-tab="models">
                            <i class="fas fa-microchip"></i> <span>AI Models</span>
                        </li>
                        <li id="admin-logout-btn">
                            <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
                        </li>
                    </ul>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="theme-toggle">
                    <i class="fas fa-moon"></i>
                    <span>Dark mode</span>
                    <label class="switch-sm">
                        <input type="checkbox" id="theme-switch">
                        <span class="slider-sm round"></span>
                    </label>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <h1 id="tab-title">Dashboard</h1>
                <div class="header-controls">
                    <div class="admin-branding">
                        <span class="branding-tag">ADMIN MODULE</span>
                    </div>
                    <div class="user-profile">
                        <div class="admin-logo-container">
                            <i class="fas fa-shield-halved admin-fallback-logo"></i>
                            <img src="" alt="Admin Logo" class="admin-avatar" id="admin-avatar-img"
                                style="display: none;">
                        </div>
                    </div>
                </div>
            </header>

            <!-- DASHBOARD TAB -->
            <section class="tab-content active" id="dashboard-tab">
                <!-- Stats Row -->
                <div class="stats-grid">
                    <div class="stat-card" onclick="switchTab('users')" style="cursor: pointer;">
                        <div class="stat-icon user-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <p>Total Users</p>
                            <h2 id="dash-total-users">--</h2>
                        </div>
                        <div class="stat-trend positive">
                            <!--<i class="fas fa-arrow-up"></i> <span>12%</span>-->
                        </div>
                    </div>

                    <div class="stat-card" onclick="switchTab('reports')" style="cursor: pointer;">
                        <div class="stat-icon report-icon">
                            <i class="fas fa-notes-medical"></i>
                        </div>
                        <div class="stat-info">
                            <p>Total Reports</p>
                            <h2 id="dash-total-reports">--</h2>
                        </div>
                        <div class="stat-trend positive">
                            <!--<i class="fas fa-arrow-up"></i> <span>5%</span>-->
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon model-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="stat-info">
                            <p>Active Model</p>
                            <h2 id="dash-active-model" style="font-size: 1.2rem;">--</h2>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon health-icon">
                            <i class="fas fa-server"></i>
                        </div>
                        <div class="stat-info">
                            <p>System Status</p>
                            <h2>Online</h2>
                        </div>
                        <div class="stat-trend positive">
                            <i class="fas fa-check"></i>
                        </div>
                    </div>
                </div>



                <!-- NEW: AI Scans Over Time Row -->
                <div class="charts-row-full">
                    <div class="chart-container full-width">
                        <div class="chart-header">
                            <div class="chart-title-group">
                                <h3>AI Scans Over Time</h3>
                                <p class="chart-subtitle">Frequency of diagnostic analysis across the platform</p>
                            </div>
                            <div class="chart-filters" id="scan-filters">
                                <button class="filter-pill active" data-range="daily">Daily</button>
                                <button class="filter-pill" data-range="weekly">Weekly</button>
                                <button class="filter-pill" data-range="monthly">Monthly</button>
                            </div>
                        </div>
                        <div class="canvas-wrapper">
                            <canvas id="scansChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- USERS TAB -->
            <section class="tab-content" id="users-tab">
                <div class="content-header">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="user-search" placeholder="Search users...">
                    </div>
                </div>
                <div class="table-container glass-morphism">
                    <table id="users-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Status</th>
                                <th>Assigned Model</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-list">
                            <!-- JS populated -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- MODELS TAB -->
            <section class="tab-content" id="models-tab">
                <div class="model-grid">
                    <div class="settings-card glass-morphism">
                        <h3><i class="fas fa-globe"></i> Global Default Model</h3>
                        <p class="helper-text">Set the default AI model for all new and unassigned users.</p>
                        <div class="model-selection" id="global-models">
                            <!-- JS populated -->
                        </div>
                        <button class="btn-primary" id="save-global-model">Update Global Model</button>
                    </div>

                    <div class="settings-card glass-morphism">
                        <h3><i class="fas fa-cloud-upload-alt"></i> Upload New Model</h3>
                        <p class="helper-text">Add a new PyTorch model (.pth) to the system.</p>
                        <form id="upload-model-form" class="upload-area-mini">
                            <input type="file" id="model-file-input" accept=".pth" hidden>
                            <div class="file-drop-zone" onclick="document.getElementById('model-file-input').click()">
                                <i class="fas fa-file-arrow-up"></i>
                                <p id="model-file-name">Click to select .pth file</p>
                            </div>
                            <button type="submit" class="btn-primary full-width" id="btn-upload-model">
                                <i class="fas fa-upload"></i> Upload Model
                            </button>
                        </form>
                    </div>

                    <div class="settings-card glass-morphism">
                        <h3><i class="fas fa-info-circle"></i> Active Model Info</h3>
                        <div id="active-model-details">
                            <p>Loading model information...</p>
                        </div>
                        <div id="model-classes-section" class="model-classes-container" style="display: none;">
                            <h4><i class="fas fa-microscope"></i> Supported Disease Classes</h4>
                            <div id="model-classes-list" class="class-tags">
                                <!-- JS populated -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- DATA/REPORTS TAB -->
            <section class="tab-content" id="reports-tab">
                <div class="data-stats">
                    <!-- Optional sub-stats for data can go here -->
                </div>
                <div id="reports-grouped-container" class="reports-accordion-container">
                    <!-- JS populated user-grouped accordions -->
                    <div class="empty-state">Loading diagnostics data...</div>
                </div>
            </section>
        </main>
    </div>

    <!-- User Edit Modal -->
    <div class="modal" id="user-edit-modal">
        <div class="modal-content glass-morphism">
            <span class="close-modal">&times;</span>
            <h2 id="modal-user-name">Edit User</h2>
            <form id="edit-user-form">
                <div class="input-group">
                    <label>Assigned Model</label>
                    <select id="user-model-assign">
                        <option value="">Default (Global)</option>
                        <!-- JS populated -->
                    </select>
                </div>
                <div class="input-group">
                    <label>Account Status</label>
                    <select id="user-status-assign">
                        <option value="ACTIVE">Active</option>
                        <option value="LOCKED">Locked</option>
                        <option value="BANNED">Banned</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Admin Privileges</label>
                    <label class="switch">
                        <input type="checkbox" id="user-admin-toggle">
                        <span class="slider round"></span>
                    </label>
                </div>
                <button type="submit" class="btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <script src="admin.js"></script>
</body>

</html>